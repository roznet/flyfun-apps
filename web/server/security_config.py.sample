#!/usr/bin/env python3

"""
Security configuration for the Euro AIP Airport Explorer - SAMPLE

This file contains ONLY configuration values - no logic functions.
Logic functions are in config_helpers.py (managed by git).

Copy this file to security_config.py and customize for your environment.
"""

import os
from typing import List

# ============================================================================
# ENVIRONMENT-SPECIFIC CONFIGURATION
# Customize these values for your deployment (development/production)
# ============================================================================

# Environment Configuration
ENVIRONMENT = os.getenv("ENVIRONMENT", "development")
FORCE_HTTPS = ENVIRONMENT == "production"

# Directory Security
# In production, all file paths will be validated against these directories
# Add all directories where your databases and config files are located
ALLOWED_DIRS = [
    "./",  # Current directory
    # Add more paths as needed, e.g.:
    # "/var/www/flyfun-apps/data",
    # "/var/www/flyfun-apps/tmp",
]

# CORS Configuration
# Add your domains here
ALLOWED_ORIGINS = [
    "http://127.0.0.1:8000",
    "http://localhost:8000",
]

# Trusted Hosts Configuration
# Add your domains here
ALLOWED_HOSTS = [
    "localhost",
    "127.0.0.1",
    "localhost:8000",
    "127.0.0.1:8000",
]

# ============================================================================
# GENERAL CONFIGURATION
# These are reasonable defaults, but can be customized if needed
# ============================================================================

# Rate Limiting Configuration
RATE_LIMIT_WINDOW = 60  # 1 minute
RATE_LIMIT_MAX_REQUESTS = 100  # 100 requests per minute

# Input Validation Limits
MAX_QUERY_LENGTH = 100
MAX_ICAO_LENGTH = 4
MIN_ICAO_LENGTH = 4
MAX_COUNTRY_LENGTH = 3
MAX_PROCEDURE_TYPE_LENGTH = 50
MAX_RUNWAY_LENGTH = 10
MAX_AUTHORITY_LENGTH = 100
MAX_SOURCE_LENGTH = 100
MAX_SECTION_LENGTH = 100
MAX_STD_FIELD_LENGTH = 100

# Pagination Limits
MAX_LIMIT = 10000
MIN_LIMIT = 1
MAX_OFFSET = 100000
MIN_OFFSET = 0

# Distance Limits
MIN_DISTANCE_NM = 0.1
MAX_DISTANCE_NM = 100.0

# Security Headers
SECURITY_HEADERS = {
    "X-Content-Type-Options": "nosniff",
    "X-Frame-Options": "DENY",
    "X-XSS-Protection": "1; mode=block",
    "Referrer-Policy": "strict-origin-when-cross-origin",
    "Content-Security-Policy": "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com; img-src 'self' data: https: https://*.tile.openstreetmap.org; font-src 'self' https: https://cdnjs.cloudflare.com; connect-src 'self' https:;"
}

# Logging Configuration
LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
LOG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# API Security
API_KEY_REQUIRED = os.getenv("API_KEY_REQUIRED", "false").lower() == "true"
API_KEY = os.getenv("API_KEY", "")

# Session Security
SESSION_SECRET_KEY = os.getenv("SESSION_SECRET_KEY", "your-secret-key-change-in-production")
SESSION_COOKIE_SECURE = ENVIRONMENT == "production"
SESSION_COOKIE_HTTPONLY = True
SESSION_COOKIE_SAMESITE = "Lax"
